require "spec_helper"


module ViolentRuby
  describe VulnerabilityScanner do
    context '#new' do
      before(:each) { @scanner = VulnerabilityScanner.new } 
      it 'defaults to no targets' do
        expect(@scanner.targets.empty?).to be(true)  
      end
      it 'defaults to no vulnerabilities' do
        expect(@scanner.known_vulnerabilities.empty?).to be(true)  
      end  
      it 'can add a target' do
        @scanner.targets = '127.0.0.1'
        expect(@scanner.targets.empty?).to be(false)  
        expect(@scanner.targets).to eq(['127.0.0.1'])  
      end  
    end
  end
end

